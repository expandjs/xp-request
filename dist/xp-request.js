!function(t){function e(s){if(n[s])return n[s].exports;var i=n[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,e,n){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=7)}([function(t,e,n){(function(e){const s="undefined"!=typeof window?window:e,i="undefined"!=typeof window?null:n(5),r="undefined"!=typeof window?null:n(6),o="undefined"!=typeof window?{}:i.STATUS_CODES,h=s.location||{},u=s.XP||n(2),a=s.XPBuffer||n(3),d=s.XPEmitter||n(4);t.exports=s.XPRequest=new u.Class("XPRequest",{extends:d,initialize:{promise:!0,value(t,e){u.attempt(e=>{d.call(this),u.isObject(t)||(t={url:t}),u.isFalsy(t.url)||Object.assign(t,u.pick(u.parseURL(t.url),["hostname","path","port","protocol"])),this.downLoaded=0,this.chunks=[],this.state="idle",this.options=t,this.headers=this.options.headers||{},this.hostname=this.options.hostname||h.hostname||"",this.keepAlive=this.options.keepAlive||0,this.method=this.options.method||"GET",this.parser=this.options.parser||"json",this.path=this.options.path||"",this.port=this.options.port||!this.options.hostname&&h.port||null,this.protocol=this.options.protocol||!this.options.hostname&&h.protocol||"http:",this.url=u.toURL({protocol:this.protocol,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search}),this._handleDownload=this._handleDownload.bind(this),this._handleEnd=this._handleEnd.bind(this,e),this._handleError=this._handleError.bind(this,e),this._handleResponse=this._handleResponse.bind(this,e)},e)}},header(t,e){return u.assertArgument(u.isString(t,!0),1,"string"),u.assertArgument(u.isVoid(e)||u.isFalse(e)||u.isInput(e,!0),2,"string"),u.isDefined(e)?void("idle"===this.state&&(e?this.headers[t]=e:delete this.headers[t])):this.headers[t]},abort:{callback:!0,value(t){return this.tsAbort||!this.tsSubmit?void t(null,!1):(this.adaptee.abort(),this.state="aborted",this.tsAbort=Date.now(),t(null,!0),this)}},submit:{callback:!0,value(t,e){if(!(u.isVoid(t)||a.isBuffer(t)||u.isInput(t)||u.isCollection(t)))return void e(u.error(400));if(!this.tsSubmit){this.ready(e);let n=["PATCH","POST","PUT"].includes(this.method),s=n?"":u.toQueryString(t,!0),o=n?t:void 0;if(o&&u.isCollection(t)&&!a.isBuffer(t)&&(o=JSON.stringify(t)),i){let t=this.adaptee=(this.protocol.startsWith("https")?r:i).request({hostname:this.hostname,keepAlive:this.keepAlive>0,keepAliveMsecs:this.keepAlive,method:this.method,path:this.pathname+(s||this.search),port:this.port,protocol:this.protocol,withCredentials:!1});Object.keys(this.headers).forEach(e=>u.isInput(this.headers[e],!0)&&t.setHeader(e,this.headers[e])),t.on("error",this._handleError),t.on("response",this._handleResponse)}if(!i){let t=this.adaptee=new XMLHttpRequest;t.open(this.method,s?`${this.url.replace(/\?.*/,``)}${s}`:this.url,!0),Object.keys(this.headers).forEach(e=>u.isInput(this.headers[e],!0)&&t.setRequestHeader(e,this.headers[e])),t.addEventListener("progress",this._handleResponse),t.addEventListener("progress",this._handleDownload),t.addEventListener("load",this._handleResponse),t.addEventListener("load",this._handleEnd),t.addEventListener("error",this._handleError),t.upload.addEventListener("error",this._handleError)}return this.state="pending",this.tsSubmit=Date.now(),this.adaptee[i?"end":"send"](o),this.emit("submit",t),this}}},adaptee:{set(t){return this.adaptee||t},validate(t){return!u.isObject(t)&&"Object"}},chunks:{set(t){return this.chunks||t},validate(t){return!u.isArray(t)&&"Array"}},data:{set(t){return u.isDefined(this.data)?this.data:t}},downLoaded:{set(t){return t},validate(t){return!u.isInt(t,!0)&&"number"}},downRatio:{get(){return u.isVoid(this.downTotal)?null:this.downTotal?this.downLoaded/this.downTotal:1}},downTotal:{set(t){return u.isDefined(this.downTotal)?this.downTotal:t},validate(t){return!u.isNull(t)&&!u.isInt(t,!0)&&"number"}},error:{set(t){return u.isDefined(this.error)?this.error:t},validate(t){return!u.isNull(t)&&!u.isObject(t)&&"Object"}},headers:{set(t){return this.headers||u.isObject(t)&&u.cloneDeep(t)},validate(t){return!u.isObject(t)&&"Object"}},hostname:{set(t){return this.hostname||t},validate(t){return!u.isString(t,!0)&&"string"}},keepAlive:{set(t){return u.isDefined(this.keepAlive)?this.keepAlive:t},validate(t){return!u.isInt(t,!0)&&"number"}},method:{set(t){return this.method||u.upperCase(t)},validate(t){return!u.isString(t,!0)&&"string"}},parser:{set(t){return this.parser||t},validate(t){return this.parsers.indexOf(t)<0&&"string"}},parsers:{frozen:!0,writable:!1,value:["buffer","json","text"]},path:{set(t){return u.isDefined(this.path)?this.path:t},then(t){let e=t.match(/([^?]*)(.*)/);this.pathname=e[1],this.search=e[2]},validate(t){return!u.isString(t)&&"string"}},pathname:{set(t){return u.isDefined(this.pathname)?this.pathname:t},validate(t){return!u.isString(t)&&"string"}},port:{set(t){return u.isDefined(this.port)?this.port:t},validate(t){return!u.isNull(t)&&!u.isNumeric(t,!0)&&"number"}},protocol:{set(t){return this.protocol||t},validate(t){return!u.isString(t,!0)&&"string"}},search:{set(t){return u.isDefined(this.search)?this.search:t},validate(t){return!u.isString(t)&&"string"}},state:{set(t){return t},then(t){return"idle"!==t&&this.emit("state",t)},validate(t){return!this.states.includes(t)&&"string"}},states:{frozen:!0,writable:!1,value:["aborted","complete","failed","idle","pending"]},statusCode:{set(t){return this.statusCode||t},validate(t){return!u.isInt(t,!0)&&"number"}},statusMessage:{set(t){return u.isDefined(this.statusMessage)?this.statusMessage:t},validate(t){return!u.isNull(t)&&!u.isString(t)&&"string"}},tsAbort:{set(t){return this.tsAbort||t},validate(t){return!u.isInt(t,!0)&&"number"}},tsData:{set(t){return this.tsData||t},validate(t){return!u.isInt(t,!0)&&"number"}},tsResponse:{set(t){return this.tsResponse||t},validate(t){return!u.isInt(t,!0)&&"number"}},tsSubmit:{set(t){return this.tsSubmit||t},validate(t){return!u.isInt(t,!0)&&"number"}},url:{set(t){return this.url||t},validate(t){return!u.isString(t,!0)&&"string"}},_handleDownload(t){i&&"buffer"!==this.parser&&this.chunks.push(t),this.emit("download",this.downLoaded+=i?a.byteLength(t):t.loaded,this.downTotal)},_handleEnd(t,e){let n=this.error||"buffer"===this.parser?null:i?this.chunks.join(""):e.target.response,s=this.error?"failed":"complete";"json"!==this.parser||this.error||(n=u.toDefined(u.parseJSON(n.toString()))),this.data=n,this.state=s,this.tsData=Date.now(),this.emit(this.error?"error":"data",this.error||n),"buffer"!==this.parser&&t(this.error,n)},_handleError(t,e){this.error=u.error(0,i?e.message:"Request not sent."),this.state="failed",this.emit("error",this.error),t(this.error,null)},_handleResponse(t,e){if(!u.isDefined(this.statusCode)){let n=i?e:e.target;this.statusCode=n[i?"statusCode":"status"],this.statusMessage=n[i?"statusMessage":"statusText"]||o[this.statusCode]||null,this.error=this.statusCode>=400?u.error(this.statusCode,this.statusMessage):null,this.downTotal=u.toDefined(u.toFinite(i?n.headers["content-length"]:n.getResponseHeader("Content-Length"))),this.tsResponse=Date.now(),i&&n.on("data",this._handleDownload),i&&n.on("end",this._handleEnd),this.emit("response",n),"buffer"===this.parser&&t(this.error,this.error?null:n)}}})}).call(e,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=XP},function(t,e){t.exports=XPBuffer},function(t,e){t.exports=XPEmitter},function(t,e){t.exports=http},function(t,e){t.exports=https},function(t,e,n){t.exports=n(0)}]);